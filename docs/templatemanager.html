<!-- ...existing code above... -->
<div id="bulk-upload-area" class="input-block" style="margin-bottom:2em;">
  <div style="font-size:1.2em;font-weight:bold;margin-bottom:0.5em;">Bulk Upload Templates</div>
  <input type="file" id="bulk-upload-input" accept=".json" multiple>
  <button id="bulk-upload-preview-btn">Preview Upload</button>
  <button id="bulk-upload-import-btn" style="display:none;">Import to Database</button>
  <div id="bulk-upload-preview"></div>
  <div id="bulk-upload-error" class="error-message"></div>
</div>
<!-- ...existing code below... -->
<script>
  // ...existing JS above...
  // --- Bulk Upload ---
  let bulkTemplates = [];
  document.getElementById("bulk-upload-preview-btn").onclick = async function() {
    const input = document.getElementById("bulk-upload-input");
    document.getElementById("bulk-upload-error").textContent = "";
    bulkTemplates = [];
    document.getElementById("bulk-upload-preview").innerHTML = "";
    document.getElementById("bulk-upload-import-btn").style.display = "none";
    if (!input.files.length) {
      document.getElementById("bulk-upload-error").textContent = "Please select at least one .json file.";
      return;
    }
    let previewHtml = "";
    for (let file of input.files) {
      try {
        const text = await file.text();
        const template = JSON.parse(text);
        // Basic validation
        if (!template.key || !template.label || !Array.isArray(template.sections)) {
          throw new Error("Invalid template structure in " + file.name);
        }
        bulkTemplates.push(template);
        previewHtml += `<div style="border:1px solid #2b90ff;border-radius:8px;padding:1em;margin-bottom:1em;">
            <b>${template.label}</b> <span style="color:#999;">(${template.key})</span><br>
            Sections: ${template.sections.length}
          </div>`;
      } catch (err) {
        document.getElementById("bulk-upload-error").textContent += `Error in ${file.name}: ${err.message}\n`;
      }
    }
    if (bulkTemplates.length) {
      document.getElementById("bulk-upload-preview").innerHTML = previewHtml;
      document.getElementById("bulk-upload-import-btn").style.display = "";
    }
  };

  document.getElementById("bulk-upload-import-btn").onclick = async function() {
    if (!bulkTemplates.length) return;
    document.getElementById("bulk-upload-error").textContent = "";
    let errorCount = 0;
    for (const template of bulkTemplates) {
      try {
        await firebase.database().ref("global_templates/" + template.key).set(template);
      } catch (err) {
        errorCount++;
        document.getElementById("bulk-upload-error").textContent += `Error importing ${template.label}: ${err.message}\n`;
      }
    }
    if (errorCount === 0) {
      document.getElementById("bulk-upload-error").textContent = "Import successful!";
      await fetchTemplates();
    }
  };
  // ...existing JS below...
</script>
