<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Template Creator - Tether</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { background: #f7f8fa; font-family: 'Segoe UI', Arial, sans-serif; margin:0; padding:0;}
    #main { max-width: 680px; margin: 4em auto; background: #fff; padding: 2em; border-radius: 18px; box-shadow: 0 4px 16px #e0e4eb; text-align:center;}
    .header { font-size: 2em; font-weight: bold; margin-bottom: 0.4em; color: #2b90ff;}
    .subtitle { color: #666; margin-bottom: 2em; font-size: 1.13em;}
    .select-btn { background: #2b90ff; color: #fff; border: none; border-radius: 10px; padding: 1.2em 2.5em; font-size: 1.18em; cursor: pointer; box-shadow: 0 2px 6px #d8e6f9; margin: 1em 0;}
    .select-btn:hover { background: #176fd2;}
    .desc {margin-bottom:2em; color:#333; font-size:1.04em;}
    .terra-icon, .aura-icon {font-size:2em; vertical-align:middle; margin-right:0.2em;}
    .section {text-align:left; margin:2em 0 1em 0; padding:1em 0;}
    .section-title {font-weight:bold; font-size:1.2em; margin-bottom:.3em;}
    .field-row {margin-bottom:1.2em;}
    .field-label {font-weight:500; margin-bottom:.2em; display:block;}
    input[type="text"], textarea, select {width:95%; padding:.7em; border-radius:8px; border:1px solid #dbe4f3; font-size:1em; margin-bottom:.3em;}
    textarea {min-height:60px;}
    .fields-list, .static-fields-list {margin-bottom:1em;}
    .fields-list input[type="text"], .static-fields-list input[type="text"] {width:70%; display:inline-block;}
    .remove-field, .remove-static-field {background:#fbb; border:none; border-radius:6px; padding:0.3em 0.8em; margin-left:0.6em; cursor:pointer;}
    .add-field-btn, .add-static-field-btn {background:#2b90ff; color:#fff; border:none; border-radius:6px; padding:0.45em 1.2em; margin-top:.5em; cursor:pointer;}
    .add-field-btn:hover, .add-static-field-btn:hover {background:#176fd2;}
    .preview-box {background:#faf7ff; border:1px solid #e5d8f7; border-radius:10px; padding:1em; margin-top:2em;}
    .hidden { display: none; }
    .admin-link {display:inline-block; margin-bottom:2em; font-size:1em; color:#2b90ff; background:#eaf2fb; border-radius:8px; padding:0.7em 1.5em; text-decoration:none; font-weight:bold; transition:.2s;}
    .admin-link:hover {background:#dbe4f3; color:#176fd2;}
    .dropdown-options {margin-bottom:0.5em;}
    .dropdown-options input[type="text"] {width:70%; display:inline-block; margin-right:8px;}
    .add-option-btn {background:#44c678; color:#fff; border:none; border-radius:6px; padding:0.3em 1em; cursor:pointer;}
    .remove-option-btn {background:#fbb; border:none; border-radius:6px; padding:0.2em 0.8em; cursor:pointer;}
    .image-upload {margin-top:10px;}
  </style>
</head>
<body>
<div id="main">
  <a class="admin-link" href="admin.html">&#8592; Back to Admin Page</a>
  <div class="header">Template Creator</div>
  <div class="subtitle" id="landing-subtitle">
    Choose which type of template you'd like to create.<br>
    <span style="color:#2b90ff;">Terra</span> is for unique, physical objects or places.<br>
    <span style="color:#c678dd;">Aura</span> is for abstract types or brands that share a locked template.
  </div>
  <div id="landing-choice">
    <div class="desc">
      <span class="terra-icon">&#128506;</span>
      <b>Terra Template</b><br>
      For things like cars, properties, devices, etc.<br>
      <button class="select-btn" onclick="showTerraCreator()">Create Terra Template</button>
    </div>
    <div class="desc">
      <span class="aura-icon">&#127752;</span>
      <b>Aura Template</b><br>
      For categories like beer brands, books, whiskey, etc. Every Aura uses a locked template.<br>
      <button class="select-btn" onclick="showAuraCreator()">Create Aura Template</button>
    </div>
  </div>

  <!-- Terra Template Creator Form -->
  <div id="terra-creator" class="hidden">
    <div class="section">
      <div class="section-title">Terra Tether Static Fields</div>
      <div class="static-fields-list" id="staticFieldsList"></div>
      <div class="field-row">
        <input type="text" id="newStaticFieldName" placeholder="Static field label (e.g., 'VIN Number')">
        <select id="newStaticFieldType">
          <option value="text">Text</option>
          <option value="textarea">Long Text</option>
          <option value="photo">Photo Upload</option>
          <option value="number">Number</option>
          <option value="dropdown">Dropdown</option>
        </select>
        <div id="staticDropdownOptions" class="dropdown-options hidden">
          <label style="font-size:0.97em; margin-right:4px;">Dropdown Options:</label>
          <input type="text" class="staticOptionInput" placeholder="Option text">
          <button class="add-option-btn" onclick="addStaticDropdownOption()">Add Option</button>
          <div id="staticOptionsList"></div>
        </div>
        <button class="add-static-field-btn" onclick="addStaticField()">Add Static Field</button>
      </div>
    </div>
    <div class="section">
      <div class="section-title">Terra Tether Dynamic Diary Fields (User Entry Questions)</div>
      <div class="fields-list" id="terraFieldsList"></div>
      <div class="field-row">
        <input type="text" id="terraNewFieldName" placeholder="Field label (e.g., 'Odometer Reading')">
        <select id="terraNewFieldType" onchange="onTerraFieldTypeChange()">
          <option value="text">Text</option>
          <option value="textarea">Long Text</option>
          <option value="rating">Rating (1-10)</option>
          <option value="stars">Stars (1-5)</option>
          <option value="dropdown">Dropdown</option>
          <option value="photo">Photo Upload</option>
        </select>
        <div id="terraDropdownOptions" class="dropdown-options hidden">
          <label style="font-size:0.97em; margin-right:4px;">Dropdown Options:</label>
          <input type="text" class="terraOptionInput" placeholder="Option text">
          <button class="add-option-btn" onclick="addTerraDropdownOption()">Add Option</button>
          <div id="terraOptionsList"></div>
        </div>
        <button class="add-field-btn" onclick="addTerraField()">Add Dynamic Field</button>
      </div>
    </div>
    <button class="select-btn" style="margin-top:2em;" onclick="previewTerraTemplate()">Preview Template</button>
    <button class="select-btn" style="margin-top:2em; background:#44c678;" onclick="saveTerraTemplate()">Save Terra Template</button>
    <button class="select-btn" style="margin-top:2em; background:#e5e5e5; color:#333;" onclick="backToLanding()">Back</button>
    <div id="terra-preview" class="preview-box hidden"></div>
  </div>

  <!-- Aura Template Creator Form (unchanged from previous) -->
  <div id="aura-creator" class="hidden">
    <!-- ... Aura creator code from previous version ... -->
    <!-- For brevity, not shown here, but keep as before -->
  </div>
</div>
<script>
  // Terra: Static Fields
  let staticFields = [];
  let staticDropdownOptions = [];
  // Terra: Dynamic Fields
  let terraEntryFields = [];
  let terraDropdownOptions = [];

  function showTerraCreator() {
    document.getElementById('landing-choice').classList.add('hidden');
    document.getElementById('landing-subtitle').classList.add('hidden');
    document.getElementById('terra-creator').classList.remove('hidden');
    document.getElementById('aura-creator').classList.add('hidden');
  }
  function backToLanding() {
    document.getElementById('terra-creator').classList.add('hidden');
    document.getElementById('aura-creator').classList.add('hidden');
    document.getElementById('landing-choice').classList.remove('hidden');
    document.getElementById('landing-subtitle').classList.remove('hidden');
    staticFields = [];
    staticDropdownOptions = [];
    terraEntryFields = [];
    terraDropdownOptions = [];
    document.getElementById('staticFieldsList').innerHTML = '';
    document.getElementById('terraFieldsList').innerHTML = '';
    document.getElementById('terra-preview').classList.add('hidden');
    document.getElementById('terra-preview').innerHTML = '';
    resetStaticDropdownOptions();
    resetTerraDropdownOptions();
  }

  // Static Fields Logic
  function addStaticField() {
    const name = document.getElementById('newStaticFieldName').value.trim();
    const type = document.getElementById('newStaticFieldType').value;
    if (!name) return;
    let field = {label: name, type};
    if (type === 'dropdown') {
      if (staticDropdownOptions.length === 0) {
        alert('Please add at least one dropdown option.');
        return;
      }
      field.options = [...staticDropdownOptions];
    }
    staticFields.push(field);
    renderStaticFields();
    document.getElementById('newStaticFieldName').value = '';
    document.getElementById('newStaticFieldType').value = 'text';
    resetStaticDropdownOptions();
    document.getElementById('staticDropdownOptions').classList.add('hidden');
  }
  function removeStaticField(idx) {
    staticFields.splice(idx, 1);
    renderStaticFields();
  }
  function renderStaticFields() {
    const list = document.getElementById('staticFieldsList');
    list.innerHTML = '';
    staticFields.forEach((field, idx) => {
      let extra = '';
      if (field.type === 'dropdown' && field.options) {
        extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
      }
      list.innerHTML += `
        <div>
          <span style="font-weight:500;">${field.label}</span>
          <span style="font-size:0.95em; color:#888;">[${field.type}]</span>${extra}
          <button class="remove-static-field" onclick="removeStaticField(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function onStaticFieldTypeChange() {
    const type = document.getElementById('newStaticFieldType').value;
    if (type === 'dropdown') {
      document.getElementById('staticDropdownOptions').classList.remove('hidden');
    } else {
      document.getElementById('staticDropdownOptions').classList.add('hidden');
      resetStaticDropdownOptions();
    }
  }
  document.getElementById('newStaticFieldType').addEventListener('change', onStaticFieldTypeChange);
  function addStaticDropdownOption() {
    const input = document.querySelector('.staticOptionInput');
    const val = input.value.trim();
    if (!val) return;
    staticDropdownOptions.push(val);
    renderStaticDropdownOptions();
    input.value = '';
  }
  function removeStaticDropdownOption(idx) {
    staticDropdownOptions.splice(idx, 1);
    renderStaticDropdownOptions();
  }
  function renderStaticDropdownOptions() {
    const optionsList = document.getElementById('staticOptionsList');
    optionsList.innerHTML = '';
    staticDropdownOptions.forEach((opt, idx) => {
      optionsList.innerHTML += `
        <div>
          <span>${opt}</span>
          <button class="remove-option-btn" onclick="removeStaticDropdownOption(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function resetStaticDropdownOptions() {
    staticDropdownOptions = [];
    renderStaticDropdownOptions();
    document.querySelector('.staticOptionInput').value = '';
  }

  // Dynamic Fields Logic (same as before)
  function addTerraField() {
    const name = document.getElementById('terraNewFieldName').value.trim();
    const type = document.getElementById('terraNewFieldType').value;
    if (!name) return;
    let field = {label: name, type};
    if (type === 'dropdown') {
      if (terraDropdownOptions.length === 0) {
        alert('Please add at least one dropdown option.');
        return;
      }
      field.options = [...terraDropdownOptions];
    }
    terraEntryFields.push(field);
    renderTerraFields();
    document.getElementById('terraNewFieldName').value = '';
    document.getElementById('terraNewFieldType').value = 'text';
    resetTerraDropdownOptions();
    document.getElementById('terraDropdownOptions').classList.add('hidden');
  }
  function removeTerraField(idx) {
    terraEntryFields.splice(idx, 1);
    renderTerraFields();
  }
  function renderTerraFields() {
    const list = document.getElementById('terraFieldsList');
    list.innerHTML = '';
    terraEntryFields.forEach((field, idx) => {
      let extra = '';
      if (field.type === 'dropdown' && field.options) {
        extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
      }
      list.innerHTML += `
        <div>
          <span style="font-weight:500;">${field.label}</span>
          <span style="font-size:0.95em; color:#888;">[${field.type}]</span>${extra}
          <button class="remove-field" onclick="removeTerraField(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function onTerraFieldTypeChange() {
    const type = document.getElementById('terraNewFieldType').value;
    if (type === 'dropdown') {
      document.getElementById('terraDropdownOptions').classList.remove('hidden');
    } else {
      document.getElementById('terraDropdownOptions').classList.add('hidden');
      resetTerraDropdownOptions();
    }
  }
  function addTerraDropdownOption() {
    const input = document.querySelector('.terraOptionInput');
    const val = input.value.trim();
    if (!val) return;
    terraDropdownOptions.push(val);
    renderTerraDropdownOptions();
    input.value = '';
  }
  function removeTerraDropdownOption(idx) {
    terraDropdownOptions.splice(idx, 1);
    renderTerraDropdownOptions();
  }
  function renderTerraDropdownOptions() {
    const optionsList = document.getElementById('terraOptionsList');
    optionsList.innerHTML = '';
    terraDropdownOptions.forEach((opt, idx) => {
      optionsList.innerHTML += `
        <div>
          <span>${opt}</span>
          <button class="remove-option-btn" onclick="removeTerraDropdownOption(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function resetTerraDropdownOptions() {
    terraDropdownOptions = [];
    renderTerraDropdownOptions();
    document.querySelector('.terraOptionInput').value = '';
  }

  // Preview and Save (Terra)
  function previewTerraTemplate() {
    const preview = document.getElementById('terra-preview');
    let html = `<div><b>Static Fields:</b></div>`;
    if (staticFields.length === 0) html += `<div><i>No static fields added yet.</i></div>`;
    else {
      html += '<ul>';
      staticFields.forEach(field => {
        let extra = '';
        if (field.type === 'dropdown' && field.options)
          extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
        html += `<li>${field.label} <span style="color:#888;">[${field.type}]</span>${extra}</li>`;
      });
      html += '</ul>';
    }
    html += `<div style="margin-top:1em;"><b>Dynamic Diary Fields (User Entry Questions):</b></div>`;
    if (terraEntryFields.length === 0) html += `<div><i>No dynamic fields added yet.</i></div>`;
    else {
      html += '<ul>';
      terraEntryFields.forEach(field => {
        let extra = '';
        if (field.type === 'dropdown' && field.options)
          extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
        html += `<li>${field.label} <span style="color:#888;">[${field.type}]</span>${extra}</li>`;
      });
      html += '</ul>';
    }
    preview.innerHTML = html;
    preview.classList.remove('hidden');
  }
  function saveTerraTemplate() {
    const template = {
      staticFields,
      entryFields: terraEntryFields
    };
    alert('Terra template saved!\n\n' + JSON.stringify(template, null, 2));
    backToLanding();
  }

  // Aura creator code stays as before (not shown for brevity)
  function showAuraCreator() {
    document.getElementById('landing-choice').classList.add('hidden');
    document.getElementById('landing-subtitle').classList.add('hidden');
    document.getElementById('aura-creator').classList.remove('hidden');
    document.getElementById('terra-creator').classList.add('hidden');
  }
</script>
</body>
</html>
