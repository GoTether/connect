<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Template Creator - Tether</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { background: #f7f8fa; font-family: 'Segoe UI', Arial, sans-serif; margin:0; padding:0;}
    #main { max-width: 620px; margin: 4em auto; background: #fff; padding: 2em; border-radius: 18px; box-shadow: 0 4px 16px #e0e4eb; text-align:center;}
    .header { font-size: 2em; font-weight: bold; margin-bottom: 0.4em; color: #2b90ff;}
    .subtitle { color: #666; margin-bottom: 2em; font-size: 1.13em;}
    .select-btn { background: #2b90ff; color: #fff; border: none; border-radius: 10px; padding: 1.2em 2.5em; font-size: 1.18em; cursor: pointer; box-shadow: 0 2px 6px #d8e6f9; margin: 1em 0;}
    .select-btn:hover { background: #176fd2;}
    .desc {margin-bottom:2em; color:#333; font-size:1.04em;}
    .terra-icon, .aura-icon {font-size:2em; vertical-align:middle; margin-right:0.2em;}
    .section {text-align:left; margin:2em 0 1em 0; padding:1em 0;}
    .section-title {font-weight:bold; font-size:1.2em; margin-bottom:.3em;}
    .field-row {margin-bottom:1.2em;}
    .field-label {font-weight:500; margin-bottom:.2em; display:block;}
    input[type="text"], textarea, select {width:95%; padding:.7em; border-radius:8px; border:1px solid #dbe4f3; font-size:1em; margin-bottom:.3em;}
    textarea {min-height:60px;}
    .fields-list {margin-bottom:1em;}
    .fields-list input[type="text"] {width:70%; display:inline-block;}
    .remove-field {background:#fbb; border:none; border-radius:6px; padding:0.3em 0.8em; margin-left:0.6em; cursor:pointer;}
    .add-field-btn {background:#2b90ff; color:#fff; border:none; border-radius:6px; padding:0.45em 1.2em; margin-top:.5em; cursor:pointer;}
    .add-field-btn:hover {background:#176fd2;}
    .preview-box {background:#faf7ff; border:1px solid #e5d8f7; border-radius:10px; padding:1em; margin-top:2em;}
    .hidden { display: none; }
    .admin-link {display:inline-block; margin-bottom:2em; font-size:1em; color:#2b90ff; background:#eaf2fb; border-radius:8px; padding:0.7em 1.5em; text-decoration:none; font-weight:bold; transition:.2s;}
    .admin-link:hover {background:#dbe4f3; color:#176fd2;}
    .link-row {display:flex; gap:8px; margin-bottom:8px;}
    .link-row input[type="text"] {width:45%;}
    .add-link-btn {background:#2b90ff; color:#fff; border:none; border-radius:6px; padding:0.3em 1em; cursor:pointer;}
    .remove-link-btn {background:#fbb; border:none; border-radius:6px; padding:0.2em 0.8em; cursor:pointer;}
    .dropdown-options {margin-bottom:0.5em;}
    .dropdown-options input[type="text"] {width:70%; display:inline-block; margin-right:8px;}
    .add-option-btn {background:#44c678; color:#fff; border:none; border-radius:6px; padding:0.3em 1em; cursor:pointer;}
    .remove-option-btn {background:#fbb; border:none; border-radius:6px; padding:0.2em 0.8em; cursor:pointer;}
    .image-upload {margin-top:10px;}
  </style>
</head>
<body>
<div id="main">
  <a class="admin-link" href="admin.html">&#8592; Back to Admin Page</a>
  <div class="header">Template Creator</div>
  <div class="subtitle" id="landing-subtitle">
    Choose which type of template you'd like to create.<br>
    <span style="color:#2b90ff;">Terra</span> is for unique, physical objects or places.<br>
    <span style="color:#c678dd;">Aura</span> is for abstract types or brands that share a locked template.
  </div>
  <div id="landing-choice">
    <div class="desc">
      <span class="terra-icon">&#128506;</span>
      <b>Terra Template</b><br>
      For things like cars, properties, devices, etc.<br>
      <button class="select-btn" onclick="showTerraCreator()">Create Terra Template</button>
    </div>
    <div class="desc">
      <span class="aura-icon">&#127752;</span>
      <b>Aura Template</b><br>
      For categories like beer brands, books, whiskey, etc. Every Aura uses a locked template.<br>
      <button class="select-btn" onclick="showAuraCreator()">Create Aura Template</button>
    </div>
  </div>

  <!-- Aura Template Creator Form -->
  <div id="aura-creator" class="hidden">
    <div class="section">
      <div class="section-title">Aura Tether Static Info</div>
      <div class="field-row">
        <label class="field-label">Tether Type (e.g., Beer, Whiskey, Book)</label>
        <input type="text" id="tetherType" placeholder="Whiskey">
      </div>
      <div class="field-row">
        <label class="field-label">Description (for brand/tether page)</label>
        <textarea id="tetherDesc" placeholder="Describe this type, e.g., 'Single malt Scotch whiskies'"></textarea>
      </div>
      <div class="field-row">
        <label class="field-label">Image/Logo (optional)</label>
        <input type="file" id="tetherImage">
      </div>
      <div class="field-row">
        <label class="field-label">External Links</label>
        <div id="linksList">
          <div class="link-row">
            <input type="text" placeholder="Label (e.g., Official Site)" class="linkLabel">
            <input type="text" placeholder="URL" class="linkUrl">
            <button class="remove-link-btn" onclick="removeLink(this)">Remove</button>
          </div>
        </div>
        <button class="add-link-btn" onclick="addLink()">Add Another Link</button>
      </div>
    </div>
    <div class="section">
      <div class="section-title">User Diary Entry Fields (Questions)</div>
      <div class="fields-list" id="fieldsList"></div>
      <div class="field-row">
        <input type="text" id="newFieldName" placeholder="Question/field label (e.g., 'Where did you drink this?')">
        <select id="newFieldType" onchange="onFieldTypeChange()">
          <option value="text">Text</option>
          <option value="textarea">Long Text</option>
          <option value="rating">Rating (1-10)</option>
          <option value="stars">Stars (1-5)</option>
          <option value="dropdown">Dropdown</option>
          <option value="photo">Photo Upload</option>
        </select>
        <div id="dropdownOptions" class="dropdown-options hidden">
          <label style="font-size:0.97em; margin-right:4px;">Dropdown Options:</label>
          <input type="text" class="optionInput" placeholder="Option text">
          <button class="add-option-btn" onclick="addDropdownOption()">Add Option</button>
          <div id="optionsList"></div>
        </div>
        <button class="add-field-btn" onclick="addField()">Add Field</button>
      </div>
    </div>
    <button class="select-btn" style="margin-top:2em;" onclick="previewAuraTemplate()">Preview Template</button>
    <button class="select-btn" style="margin-top:2em; background:#44c678;" onclick="saveAuraTemplate()">Save Aura Template</button>
    <button class="select-btn" style="margin-top:2em; background:#e5e5e5; color:#333;" onclick="backToLanding()">Back</button>
    <div id="aura-preview" class="preview-box hidden"></div>
  </div>

  <!-- Terra Template Creator Form -->
  <div id="terra-creator" class="hidden">
    <div class="section">
      <div class="section-title">Terra Tether Static Info</div>
      <div class="field-row">
        <label class="field-label">Tether Name (e.g., Car, Property, Device)</label>
        <input type="text" id="terraTetherName" placeholder="Tesla Model S">
      </div>
      <div class="field-row">
        <label class="field-label">Description</label>
        <textarea id="terraTetherDesc" placeholder="Describe this object, e.g., 'Electric sports sedan'"></textarea>
      </div>
      <div class="field-row image-upload">
        <label class="field-label">Image/Photo (optional)</label>
        <input type="file" id="terraTetherImage">
      </div>
    </div>
    <div class="section">
      <div class="section-title">Custom Fields (User Entry Questions)</div>
      <div class="fields-list" id="terraFieldsList"></div>
      <div class="field-row">
        <input type="text" id="terraNewFieldName" placeholder="Field label (e.g., 'Odometer Reading')">
        <select id="terraNewFieldType" onchange="onTerraFieldTypeChange()">
          <option value="text">Text</option>
          <option value="textarea">Long Text</option>
          <option value="rating">Rating (1-10)</option>
          <option value="stars">Stars (1-5)</option>
          <option value="dropdown">Dropdown</option>
          <option value="photo">Photo Upload</option>
        </select>
        <div id="terraDropdownOptions" class="dropdown-options hidden">
          <label style="font-size:0.97em; margin-right:4px;">Dropdown Options:</label>
          <input type="text" class="terraOptionInput" placeholder="Option text">
          <button class="add-option-btn" onclick="addTerraDropdownOption()">Add Option</button>
          <div id="terraOptionsList"></div>
        </div>
        <button class="add-field-btn" onclick="addTerraField()">Add Field</button>
      </div>
    </div>
    <button class="select-btn" style="margin-top:2em;" onclick="previewTerraTemplate()">Preview Template</button>
    <button class="select-btn" style="margin-top:2em; background:#44c678;" onclick="saveTerraTemplate()">Save Terra Template</button>
    <button class="select-btn" style="margin-top:2em; background:#e5e5e5; color:#333;" onclick="backToLanding()">Back</button>
    <div id="terra-preview" class="preview-box hidden"></div>
  </div>
</div>
<script>
  // Aura template variables
  let entryFields = [];
  let dropdownOptions = [];

  // Terra template variables
  let terraEntryFields = [];
  let terraDropdownOptions = [];

  function showAuraCreator() {
    document.getElementById('landing-choice').classList.add('hidden');
    document.getElementById('landing-subtitle').classList.add('hidden');
    document.getElementById('aura-creator').classList.remove('hidden');
    document.getElementById('terra-creator').classList.add('hidden');
  }
  function showTerraCreator() {
    document.getElementById('landing-choice').classList.add('hidden');
    document.getElementById('landing-subtitle').classList.add('hidden');
    document.getElementById('terra-creator').classList.remove('hidden');
    document.getElementById('aura-creator').classList.add('hidden');
  }
  function backToLanding() {
    document.getElementById('aura-creator').classList.add('hidden');
    document.getElementById('terra-creator').classList.add('hidden');
    document.getElementById('landing-choice').classList.remove('hidden');
    document.getElementById('landing-subtitle').classList.remove('hidden');
    entryFields = [];
    dropdownOptions = [];
    terraEntryFields = [];
    terraDropdownOptions = [];
    document.getElementById('fieldsList').innerHTML = '';
    document.getElementById('aura-preview').classList.add('hidden');
    document.getElementById('aura-preview').innerHTML = '';
    resetLinks();
    resetDropdownOptions();
    document.getElementById('terraFieldsList').innerHTML = '';
    document.getElementById('terra-preview').classList.add('hidden');
    document.getElementById('terra-preview').innerHTML = '';
    resetTerraDropdownOptions();
  }

  // External Links Logic (Aura)
  function addLink() {
    const linksList = document.getElementById('linksList');
    const div = document.createElement('div');
    div.className = 'link-row';
    div.innerHTML = `
      <input type="text" placeholder="Label (e.g., Official Site)" class="linkLabel">
      <input type="text" placeholder="URL" class="linkUrl">
      <button class="remove-link-btn" onclick="removeLink(this)">Remove</button>
    `;
    linksList.appendChild(div);
  }
  function removeLink(btn) {
    btn.parentElement.remove();
  }
  function resetLinks() {
    const linksList = document.getElementById('linksList');
    linksList.innerHTML = `
      <div class="link-row">
        <input type="text" placeholder="Label (e.g., Official Site)" class="linkLabel">
        <input type="text" placeholder="URL" class="linkUrl">
        <button class="remove-link-btn" onclick="removeLink(this)">Remove</button>
      </div>
    `;
  }

  // Entry Fields Logic (Aura)
  function addField() {
    const name = document.getElementById('newFieldName').value.trim();
    const type = document.getElementById('newFieldType').value;
    if (!name) return;
    let field = {label: name, type};

    if (type === 'dropdown') {
      if (dropdownOptions.length === 0) {
        alert('Please add at least one dropdown option.');
        return;
      }
      field.options = [...dropdownOptions];
    }
    entryFields.push(field);
    renderFields();
    document.getElementById('newFieldName').value = '';
    document.getElementById('newFieldType').value = 'text';
    resetDropdownOptions();
    document.getElementById('dropdownOptions').classList.add('hidden');
  }
  function removeField(idx) {
    entryFields.splice(idx, 1);
    renderFields();
  }
  function renderFields() {
    const list = document.getElementById('fieldsList');
    list.innerHTML = '';
    entryFields.forEach((field, idx) => {
      let extra = '';
      if (field.type === 'dropdown' && field.options) {
        extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
      }
      list.innerHTML += `
        <div>
          <span style="font-weight:500;">${field.label}</span>
          <span style="font-size:0.95em; color:#888;">[${field.type}]</span>${extra}
          <button class="remove-field" onclick="removeField(${idx})">Remove</button>
        </div>
      `;
    });
  }

  // Dropdown Option Logic (Aura)
  function onFieldTypeChange() {
    const type = document.getElementById('newFieldType').value;
    if (type === 'dropdown') {
      document.getElementById('dropdownOptions').classList.remove('hidden');
    } else {
      document.getElementById('dropdownOptions').classList.add('hidden');
      resetDropdownOptions();
    }
  }
  function addDropdownOption() {
    const input = document.querySelector('.optionInput');
    const val = input.value.trim();
    if (!val) return;
    dropdownOptions.push(val);
    renderDropdownOptions();
    input.value = '';
  }
  function removeDropdownOption(idx) {
    dropdownOptions.splice(idx, 1);
    renderDropdownOptions();
  }
  function renderDropdownOptions() {
    const optionsList = document.getElementById('optionsList');
    optionsList.innerHTML = '';
    dropdownOptions.forEach((opt, idx) => {
      optionsList.innerHTML += `
        <div>
          <span>${opt}</span>
          <button class="remove-option-btn" onclick="removeDropdownOption(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function resetDropdownOptions() {
    dropdownOptions = [];
    renderDropdownOptions();
    document.querySelector('.optionInput').value = '';
  }

  // Preview and Save (Aura)
  function previewAuraTemplate() {
    const type = document.getElementById('tetherType').value.trim();
    const desc = document.getElementById('tetherDesc').value.trim();
    const preview = document.getElementById('aura-preview');
    let html = `<div><b>Tether Type:</b> ${type || '<i>(none)</i>'}</div>`;
    html += `<div><b>Description:</b> ${desc || '<i>(none)</i>'}</div>`;
    // External Links
    const linksList = document.getElementById('linksList').querySelectorAll('.link-row');
    let links = [];
    linksList.forEach(row => {
      const label = row.querySelector('.linkLabel').value.trim();
      const url = row.querySelector('.linkUrl').value.trim();
      if (label && url) links.push({label, url});
    });
    if (links.length > 0) {
      html += `<div style="margin-top:1em;"><b>Links:</b><ul>`;
      links.forEach(link => {
        html += `<li>${link.label}: <a href="${link.url}" target="_blank">${link.url}</a></li>`;
      });
      html += `</ul></div>`;
    }
    html += `<div style="margin-top:1em;"><b>User Diary Entry Fields:</b></div>`;
    if (entryFields.length === 0) html += `<div><i>No entry fields added yet.</i></div>`;
    else {
      html += '<ul>';
      entryFields.forEach(field => {
        let extra = '';
        if (field.type === 'dropdown' && field.options)
          extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
        html += `<li>${field.label} <span style="color:#888;">[${field.type}]</span>${extra}</li>`;
      });
      html += '</ul>';
    }
    preview.innerHTML = html;
    preview.classList.remove('hidden');
  }
  function saveAuraTemplate() {
    const type = document.getElementById('tetherType').value.trim();
    const desc = document.getElementById('tetherDesc').value.trim();
    let image = document.getElementById('tetherImage').files[0] || null;
    // Gather links
    const linksList = document.getElementById('linksList').querySelectorAll('.link-row');
    let links = [];
    linksList.forEach(row => {
      const label = row.querySelector('.linkLabel').value.trim();
      const url = row.querySelector('.linkUrl').value.trim();
      if (label && url) links.push({label, url});
    });
    const template = {
      tetherType: type,
      description: desc,
      image,
      links,
      entryFields
    };
    alert('Aura template saved!\n\n' + JSON.stringify(template, null, 2));
    backToLanding();
  }

  // Terra Entry Fields Logic
  function addTerraField() {
    const name = document.getElementById('terraNewFieldName').value.trim();
    const type = document.getElementById('terraNewFieldType').value;
    if (!name) return;
    let field = {label: name, type};
    if (type === 'dropdown') {
      if (terraDropdownOptions.length === 0) {
        alert('Please add at least one dropdown option.');
        return;
      }
      field.options = [...terraDropdownOptions];
    }
    terraEntryFields.push(field);
    renderTerraFields();
    document.getElementById('terraNewFieldName').value = '';
    document.getElementById('terraNewFieldType').value = 'text';
    resetTerraDropdownOptions();
    document.getElementById('terraDropdownOptions').classList.add('hidden');
  }
  function removeTerraField(idx) {
    terraEntryFields.splice(idx, 1);
    renderTerraFields();
  }
  function renderTerraFields() {
    const list = document.getElementById('terraFieldsList');
    list.innerHTML = '';
    terraEntryFields.forEach((field, idx) => {
      let extra = '';
      if (field.type === 'dropdown' && field.options) {
        extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
      }
      list.innerHTML += `
        <div>
          <span style="font-weight:500;">${field.label}</span>
          <span style="font-size:0.95em; color:#888;">[${field.type}]</span>${extra}
          <button class="remove-field" onclick="removeTerraField(${idx})">Remove</button>
        </div>
      `;
    });
  }

  // Terra Dropdown Option Logic
  function onTerraFieldTypeChange() {
    const type = document.getElementById('terraNewFieldType').value;
    if (type === 'dropdown') {
      document.getElementById('terraDropdownOptions').classList.remove('hidden');
    } else {
      document.getElementById('terraDropdownOptions').classList.add('hidden');
      resetTerraDropdownOptions();
    }
  }
  function addTerraDropdownOption() {
    const input = document.querySelector('.terraOptionInput');
    const val = input.value.trim();
    if (!val) return;
    terraDropdownOptions.push(val);
    renderTerraDropdownOptions();
    input.value = '';
  }
  function removeTerraDropdownOption(idx) {
    terraDropdownOptions.splice(idx, 1);
    renderTerraDropdownOptions();
  }
  function renderTerraDropdownOptions() {
    const optionsList = document.getElementById('terraOptionsList');
    optionsList.innerHTML = '';
    terraDropdownOptions.forEach((opt, idx) => {
      optionsList.innerHTML += `
        <div>
          <span>${opt}</span>
          <button class="remove-option-btn" onclick="removeTerraDropdownOption(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function resetTerraDropdownOptions() {
    terraDropdownOptions = [];
    renderTerraDropdownOptions();
    document.querySelector('.terraOptionInput').value = '';
  }

  // Preview and Save (Terra)
  function previewTerraTemplate() {
    const name = document.getElementById('terraTetherName').value.trim();
    const desc = document.getElementById('terraTetherDesc').value.trim();
    const preview = document.getElementById('terra-preview');
    let html = `<div><b>Tether Name:</b> ${name || '<i>(none)</i>'}</div>`;
    html += `<div><b>Description:</b> ${desc || '<i>(none)</i>'}</div>`;
    html += `<div style="margin-top:1em;"><b>Custom Entry Fields:</b></div>`;
    if (terraEntryFields.length === 0) html += `<div><i>No custom fields added yet.</i></div>`;
    else {
      html += '<ul>';
      terraEntryFields.forEach(field => {
        let extra = '';
        if (field.type === 'dropdown' && field.options)
          extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
        html += `<li>${field.label} <span style="color:#888;">[${field.type}]</span>${extra}</li>`;
      });
      html += '</ul>';
    }
    preview.innerHTML = html;
    preview.classList.remove('hidden');
  }
  function saveTerraTemplate() {
    const name = document.getElementById('terraTetherName').value.trim();
    const desc = document.getElementById('terraTetherDesc').value.trim();
    let image = document.getElementById('terraTetherImage').files[0] || null;
    const template = {
      tetherName: name,
      description: desc,
      image,
      entryFields: terraEntryFields
    };
    alert('Terra template saved!\n\n' + JSON.stringify(template, null, 2));
    backToLanding();
  }
</script>
</body>
</html>
