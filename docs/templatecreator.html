<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Template Creator - Tether</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { background: #f7f8fa; font-family: 'Segoe UI', Arial, sans-serif; margin:0; padding:0;}
    #main { max-width: 800px; margin: 3em auto; background: #fff; padding: 2.5em 2em; border-radius: 22px; box-shadow: 0 5px 24px #e0e4eb; }
    .admin-link {display:inline-block; margin-bottom:2em; font-size:1em; color:#2b90ff; background:#eaf2fb; border-radius:8px; padding:0.7em 1.5em; text-decoration:none; font-weight:bold; transition:.2s;}
    .admin-link:hover {background:#dbe4f3; color:#176fd2;}
    .header { font-size: 2.2em; font-weight: bold; margin-bottom: 0.6em; color: #2b90ff;}
    .subtitle { color: #666; margin-bottom: 2em; font-size: 1.13em;}
    .section-card {background: #f3f6fb; border-radius: 18px; box-shadow: 0 2px 12px #e7eaf2; padding: 1.6em 1em 1.2em 1em; margin-bottom: 2em; text-align:left;}
    .section-title {font-weight:bold; font-size:1.25em; margin-bottom:.7em; color:#2b90ff;}
    .field-row {margin-bottom:1.25em;}
    .field-label {font-weight:500; margin-bottom:.2em; display:block;}
    input[type="text"], textarea, select {width:97%; padding:.8em; border-radius:10px; border:1px solid #c6d4ed; font-size:1.07em; margin-bottom:.3em;}
    textarea {min-height:60px;}
    .fields-list, .static-fields-list, .links-list {margin-bottom:1em;}
    .fields-list input[type="text"], .static-fields-list input[type="text"] {width:70%; display:inline-block;}
    .remove-field, .remove-static-field, .remove-link-btn, .remove-option-btn {background:#fbb; border:none; border-radius:6px; padding:0.35em 0.9em; margin-left:0.6em; cursor:pointer; font-size:0.99em;}
    .add-field-btn, .add-static-field-btn, .add-link-btn, .add-option-btn {background:#2b90ff; color:#fff; border:none; border-radius:10px; padding:0.55em 1.3em; margin-top:.5em; cursor:pointer; font-size:1.07em;}
    .add-field-btn:hover, .add-static-field-btn:hover, .add-link-btn:hover, .add-option-btn:hover {background:#176fd2;}
    .preview-box {background:#f7f3fa; border:1px solid #e5d8f7; border-radius:16px; padding:1.2em; margin-top:2em; font-size:1.07em;}
    .hidden { display: none; }
    .template-tabs {display:flex; justify-content:center; gap:20px; margin-bottom:2em;}
    .tab-btn {background:#eaf2fb; color:#2b90ff; border:none; border-radius:10px; padding:0.8em 2em; font-size:1.17em; cursor:pointer; font-weight:600; transition:.2s;}
    .tab-btn.active, .tab-btn:focus {background:#2b90ff; color:#fff;}
    .desc {margin-bottom:1.7em; color:#333; font-size:1.09em;}
    .terra-icon, .aura-icon {font-size:2em; vertical-align:middle; margin-right:0.2em;}
    .dropdown-options {margin-bottom:0.5em;}
    .dropdown-options input[type="text"] {width:70%; display:inline-block; margin-right:8px;}
    .image-upload {margin-top:10px;}
    .link-row {display:flex; gap:8px; margin-bottom:8px;}
    .link-row input[type="text"] {width:43%;}
    .dropdown-options {margin-bottom:0.5em;}
    .dropdown-options input[type="text"] {width:60%; margin-right:8px;}
    .add-option-btn {background:#44c678; color:#fff;}
    .add-option-btn:hover {background:#319f4b;}
    .remove-option-btn {background:#fbb;}
    .remove-field, .remove-static-field {background:#fbb;}
    .remove-link-btn {background:#fbb;}
    .back-btn {margin-top:2em; background:#e5e5e5; color:#333;}
  </style>
</head>
<body>
<div id="main">
  <a class="admin-link" href="admin.html">&#8592; Back to Admin Page</a>
  <div class="header">Template Creator</div>
  <div class="subtitle" id="landing-subtitle">
    Choose which type of template you'd like to create.<br>
    <span style="color:#2b90ff;">Terra</span> is for unique, physical objects or places.<br>
    <span style="color:#c678dd;">Aura</span> is for abstract types or brands that share a locked template.
  </div>
  <div class="template-tabs">
    <button class="tab-btn active" id="terraTab" onclick="showTerraCreator()">Terra Template</button>
    <button class="tab-btn" id="auraTab" onclick="showAuraCreator()">Aura Template</button>
  </div>
  <!-- Terra Template Creator Form -->
  <div id="terra-creator" class="section-card">
    <div class="section-title">Terra Tether Static Fields</div>
    <div class="static-fields-list" id="staticFieldsList"></div>
    <div class="field-row">
      <input type="text" id="newStaticFieldName" placeholder="Static field label (e.g., 'VIN Number')">
      <select id="newStaticFieldType" onchange="onStaticFieldTypeChange()">
        <option value="text">Text</option>
        <option value="textarea">Long Text</option>
        <option value="photo">Photo Upload</option>
        <option value="number">Number</option>
        <option value="dropdown">Dropdown</option>
      </select>
      <div id="staticDropdownOptions" class="dropdown-options hidden">
        <label style="font-size:0.97em; margin-right:4px;">Dropdown Options:</label>
        <input type="text" class="staticOptionInput" placeholder="Option text">
        <button class="add-option-btn" onclick="addStaticDropdownOption()">Add Option</button>
        <div id="staticOptionsList"></div>
      </div>
      <button class="add-static-field-btn" onclick="addStaticField()">Add Static Field</button>
    </div>
    <hr style="margin:2em 0 1em 0; border:0; border-top:1px solid #dbe4f3;">
    <div class="section-title">Terra Tether Dynamic Diary Fields (User Entry Questions)</div>
    <div class="fields-list" id="terraFieldsList"></div>
    <div class="field-row">
      <input type="text" id="terraNewFieldName" placeholder="Dynamic field label (e.g., 'Odometer Reading')">
      <select id="terraNewFieldType" onchange="onTerraFieldTypeChange()">
        <option value="text">Text</option>
        <option value="textarea">Long Text</option>
        <option value="rating">Rating (1-10)</option>
        <option value="stars">Stars (1-5)</option>
        <option value="dropdown">Dropdown</option>
        <option value="photo">Photo Upload</option>
      </select>
      <div id="terraDropdownOptions" class="dropdown-options hidden">
        <label style="font-size:0.97em; margin-right:4px;">Dropdown Options:</label>
        <input type="text" class="terraOptionInput" placeholder="Option text">
        <button class="add-option-btn" onclick="addTerraDropdownOption()">Add Option</button>
        <div id="terraOptionsList"></div>
      </div>
      <button class="add-field-btn" onclick="addTerraField()">Add Dynamic Field</button>
    </div>
    <div style="margin-top:2em;">
      <button class="select-btn" onclick="previewTerraTemplate()">Preview Template</button>
      <button class="select-btn" style="background:#44c678;" onclick="saveTerraTemplate()">Save Terra Template</button>
      <button class="select-btn back-btn" onclick="resetTerraCreator()">Reset</button>
    </div>
    <div id="terra-preview" class="preview-box hidden"></div>
  </div>
  <!-- Aura Template Creator Form -->
  <div id="aura-creator" class="section-card hidden">
    <div class="section-title">Aura Tether Static Info</div>
    <div class="field-row">
      <input type="text" id="tetherType" placeholder="Tether Type (e.g., Whiskey)">
    </div>
    <div class="field-row">
      <textarea id="tetherDesc" placeholder="Description (for brand/tether page)"></textarea>
    </div>
    <div class="field-row image-upload">
      <label class="field-label">Image/Logo (optional)</label>
      <input type="file" id="tetherImage">
    </div>
    <div class="section-title" style="margin-top:2em;">External Links</div>
    <div class="links-list" id="linksList">
      <div class="link-row">
        <input type="text" placeholder="Label (e.g., Official Site)" class="linkLabel">
        <input type="text" placeholder="URL" class="linkUrl">
        <button class="remove-link-btn" onclick="removeLink(this)">Remove</button>
      </div>
    </div>
    <button class="add-link-btn" onclick="addLink()">Add Another Link</button>
    <hr style="margin:2em 0 1em 0; border:0; border-top:1px solid #dbe4f3;">
    <div class="section-title">User Diary Entry Fields (Questions)</div>
    <div class="fields-list" id="fieldsList"></div>
    <div class="field-row">
      <input type="text" id="newFieldName" placeholder="Question/field label (e.g., 'Where did you drink this?')">
      <select id="newFieldType" onchange="onFieldTypeChange()">
        <option value="text">Text</option>
        <option value="textarea">Long Text</option>
        <option value="rating">Rating (1-10)</option>
        <option value="stars">Stars (1-5)</option>
        <option value="dropdown">Dropdown</option>
        <option value="photo">Photo Upload</option>
      </select>
      <div id="dropdownOptions" class="dropdown-options hidden">
        <label style="font-size:0.97em; margin-right:4px;">Dropdown Options:</label>
        <input type="text" class="optionInput" placeholder="Option text">
        <button class="add-option-btn" onclick="addDropdownOption()">Add Option</button>
        <div id="optionsList"></div>
      </div>
      <button class="add-field-btn" onclick="addField()">Add Field</button>
    </div>
    <div style="margin-top:2em;">
      <button class="select-btn" onclick="previewAuraTemplate()">Preview Template</button>
      <button class="select-btn" style="background:#44c678;" onclick="saveAuraTemplate()">Save Aura Template</button>
      <button class="select-btn back-btn" onclick="resetAuraCreator()">Reset</button>
    </div>
    <div id="aura-preview" class="preview-box hidden"></div>
  </div>
</div>
<script>
  // UI tab switch
  function showTerraCreator() {
    document.getElementById('terraTab').classList.add('active');
    document.getElementById('auraTab').classList.remove('active');
    document.getElementById('terra-creator').classList.remove('hidden');
    document.getElementById('aura-creator').classList.add('hidden');
  }
  function showAuraCreator() {
    document.getElementById('terraTab').classList.remove('active');
    document.getElementById('auraTab').classList.add('active');
    document.getElementById('terra-creator').classList.add('hidden');
    document.getElementById('aura-creator').classList.remove('hidden');
  }

  // Terra: Static Fields
  let staticFields = [];
  let staticDropdownOptions = [];
  // Terra: Dynamic Fields
  let terraEntryFields = [];
  let terraDropdownOptions = [];

  // Aura template variables
  let entryFields = [];
  let dropdownOptions = [];
  // Links (Aura)
  function addLink() {
    const linksList = document.getElementById('linksList');
    const div = document.createElement('div');
    div.className = 'link-row';
    div.innerHTML = `
      <input type="text" placeholder="Label (e.g., Official Site)" class="linkLabel">
      <input type="text" placeholder="URL" class="linkUrl">
      <button class="remove-link-btn" onclick="removeLink(this)">Remove</button>
    `;
    linksList.appendChild(div);
  }
  function removeLink(btn) {
    btn.parentElement.remove();
  }
  function resetLinks() {
    const linksList = document.getElementById('linksList');
    linksList.innerHTML = `
      <div class="link-row">
        <input type="text" placeholder="Label (e.g., Official Site)" class="linkLabel">
        <input type="text" placeholder="URL" class="linkUrl">
        <button class="remove-link-btn" onclick="removeLink(this)">Remove</button>
      </div>
    `;
  }

  // Terra Static Fields Logic
  function addStaticField() {
    const name = document.getElementById('newStaticFieldName').value.trim();
    const type = document.getElementById('newStaticFieldType').value;
    if (!name) return;
    let field = {label: name, type};
    if (type === 'dropdown') {
      if (staticDropdownOptions.length === 0) {
        alert('Please add at least one dropdown option.');
        return;
      }
      field.options = [...staticDropdownOptions];
    }
    staticFields.push(field);
    renderStaticFields();
    document.getElementById('newStaticFieldName').value = '';
    document.getElementById('newStaticFieldType').value = 'text';
    resetStaticDropdownOptions();
    document.getElementById('staticDropdownOptions').classList.add('hidden');
  }
  function removeStaticField(idx) {
    staticFields.splice(idx, 1);
    renderStaticFields();
  }
  function renderStaticFields() {
    const list = document.getElementById('staticFieldsList');
    list.innerHTML = '';
    staticFields.forEach((field, idx) => {
      let extra = '';
      if (field.type === 'dropdown' && field.options) {
        extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
      }
      list.innerHTML += `
        <div>
          <span style="font-weight:500;">${field.label}</span>
          <span style="font-size:0.99em; color:#888;">[${field.type}]</span>${extra}
          <button class="remove-static-field" onclick="removeStaticField(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function onStaticFieldTypeChange() {
    const type = document.getElementById('newStaticFieldType').value;
    if (type === 'dropdown') {
      document.getElementById('staticDropdownOptions').classList.remove('hidden');
    } else {
      document.getElementById('staticDropdownOptions').classList.add('hidden');
      resetStaticDropdownOptions();
    }
  }
  function addStaticDropdownOption() {
    const input = document.querySelector('.staticOptionInput');
    const val = input.value.trim();
    if (!val) return;
    staticDropdownOptions.push(val);
    renderStaticDropdownOptions();
    input.value = '';
  }
  function removeStaticDropdownOption(idx) {
    staticDropdownOptions.splice(idx, 1);
    renderStaticDropdownOptions();
  }
  function renderStaticDropdownOptions() {
    const optionsList = document.getElementById('staticOptionsList');
    optionsList.innerHTML = '';
    staticDropdownOptions.forEach((opt, idx) => {
      optionsList.innerHTML += `
        <div>
          <span>${opt}</span>
          <button class="remove-option-btn" onclick="removeStaticDropdownOption(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function resetStaticDropdownOptions() {
    staticDropdownOptions = [];
    renderStaticDropdownOptions();
    document.querySelector('.staticOptionInput').value = '';
  }

  // Terra Dynamic Fields Logic
  function addTerraField() {
    const name = document.getElementById('terraNewFieldName').value.trim();
    const type = document.getElementById('terraNewFieldType').value;
    if (!name) return;
    let field = {label: name, type};
    if (type === 'dropdown') {
      if (terraDropdownOptions.length === 0) {
        alert('Please add at least one dropdown option.');
        return;
      }
      field.options = [...terraDropdownOptions];
    }
    terraEntryFields.push(field);
    renderTerraFields();
    document.getElementById('terraNewFieldName').value = '';
    document.getElementById('terraNewFieldType').value = 'text';
    resetTerraDropdownOptions();
    document.getElementById('terraDropdownOptions').classList.add('hidden');
  }
  function removeTerraField(idx) {
    terraEntryFields.splice(idx, 1);
    renderTerraFields();
  }
  function renderTerraFields() {
    const list = document.getElementById('terraFieldsList');
    list.innerHTML = '';
    terraEntryFields.forEach((field, idx) => {
      let extra = '';
      if (field.type === 'dropdown' && field.options) {
        extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
      }
      list.innerHTML += `
        <div>
          <span style="font-weight:500;">${field.label}</span>
          <span style="font-size:0.99em; color:#888;">[${field.type}]</span>${extra}
          <button class="remove-field" onclick="removeTerraField(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function onTerraFieldTypeChange() {
    const type = document.getElementById('terraNewFieldType').value;
    if (type === 'dropdown') {
      document.getElementById('terraDropdownOptions').classList.remove('hidden');
    } else {
      document.getElementById('terraDropdownOptions').classList.add('hidden');
      resetTerraDropdownOptions();
    }
  }
  function addTerraDropdownOption() {
    const input = document.querySelector('.terraOptionInput');
    const val = input.value.trim();
    if (!val) return;
    terraDropdownOptions.push(val);
    renderTerraDropdownOptions();
    input.value = '';
  }
  function removeTerraDropdownOption(idx) {
    terraDropdownOptions.splice(idx, 1);
    renderTerraDropdownOptions();
  }
  function renderTerraDropdownOptions() {
    const optionsList = document.getElementById('terraOptionsList');
    optionsList.innerHTML = '';
    terraDropdownOptions.forEach((opt, idx) => {
      optionsList.innerHTML += `
        <div>
          <span>${opt}</span>
          <button class="remove-option-btn" onclick="removeTerraDropdownOption(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function resetTerraDropdownOptions() {
    terraDropdownOptions = [];
    renderTerraDropdownOptions();
    document.querySelector('.terraOptionInput').value = '';
  }

  // Preview and Save (Terra)
  function previewTerraTemplate() {
    const preview = document.getElementById('terra-preview');
    let html = `<div><b>Static Fields:</b></div>`;
    if (staticFields.length === 0) html += `<div><i>No static fields added yet.</i></div>`;
    else {
      html += '<ul>';
      staticFields.forEach(field => {
        let extra = '';
        if (field.type === 'dropdown' && field.options)
          extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
        html += `<li>${field.label} <span style="color:#888;">[${field.type}]</span>${extra}</li>`;
      });
      html += '</ul>';
    }
    html += `<div style="margin-top:1em;"><b>Dynamic Diary Fields (User Entry Questions):</b></div>`;
    if (terraEntryFields.length === 0) html += `<div><i>No dynamic fields added yet.</i></div>`;
    else {
      html += '<ul>';
      terraEntryFields.forEach(field => {
        let extra = '';
        if (field.type === 'dropdown' && field.options)
          extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
        html += `<li>${field.label} <span style="color:#888;">[${field.type}]</span>${extra}</li>`;
      });
      html += '</ul>';
    }
    preview.innerHTML = html;
    preview.classList.remove('hidden');
  }
  function saveTerraTemplate() {
    const template = {
      staticFields,
      entryFields: terraEntryFields
    };
    alert('Terra template saved!\n\n' + JSON.stringify(template, null, 2));
    resetTerraCreator();
  }
  function resetTerraCreator() {
    staticFields = [];
    staticDropdownOptions = [];
    terraEntryFields = [];
    terraDropdownOptions = [];
    document.getElementById('staticFieldsList').innerHTML = '';
    document.getElementById('terraFieldsList').innerHTML = '';
    document.getElementById('terra-preview').classList.add('hidden');
    document.getElementById('terra-preview').innerHTML = '';
    resetStaticDropdownOptions();
    resetTerraDropdownOptions();
    document.getElementById('newStaticFieldName').value = '';
    document.getElementById('newStaticFieldType').value = 'text';
    document.getElementById('terraNewFieldName').value = '';
    document.getElementById('terraNewFieldType').value = 'text';
  }

  // Aura Diary Entry Fields Logic
  function addField() {
    const name = document.getElementById('newFieldName').value.trim();
    const type = document.getElementById('newFieldType').value;
    if (!name) return;
    let field = {label: name, type};
    if (type === 'dropdown') {
      if (dropdownOptions.length === 0) {
        alert('Please add at least one dropdown option.');
        return;
      }
      field.options = [...dropdownOptions];
    }
    entryFields.push(field);
    renderFields();
    document.getElementById('newFieldName').value = '';
    document.getElementById('newFieldType').value = 'text';
    resetDropdownOptions();
    document.getElementById('dropdownOptions').classList.add('hidden');
  }
  function removeField(idx) {
    entryFields.splice(idx, 1);
    renderFields();
  }
  function renderFields() {
    const list = document.getElementById('fieldsList');
    list.innerHTML = '';
    entryFields.forEach((field, idx) => {
      let extra = '';
      if (field.type === 'dropdown' && field.options) {
        extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
      }
      list.innerHTML += `
        <div>
          <span style="font-weight:500;">${field.label}</span>
          <span style="font-size:0.99em; color:#888;">[${field.type}]</span>${extra}
          <button class="remove-field" onclick="removeField(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function onFieldTypeChange() {
    const type = document.getElementById('newFieldType').value;
    if (type === 'dropdown') {
      document.getElementById('dropdownOptions').classList.remove('hidden');
    } else {
      document.getElementById('dropdownOptions').classList.add('hidden');
      resetDropdownOptions();
    }
  }
  function addDropdownOption() {
    const input = document.querySelector('.optionInput');
    const val = input.value.trim();
    if (!val) return;
    dropdownOptions.push(val);
    renderDropdownOptions();
    input.value = '';
  }
  function removeDropdownOption(idx) {
    dropdownOptions.splice(idx, 1);
    renderDropdownOptions();
  }
  function renderDropdownOptions() {
    const optionsList = document.getElementById('optionsList');
    optionsList.innerHTML = '';
    dropdownOptions.forEach((opt, idx) => {
      optionsList.innerHTML += `
        <div>
          <span>${opt}</span>
          <button class="remove-option-btn" onclick="removeDropdownOption(${idx})">Remove</button>
        </div>
      `;
    });
  }
  function resetDropdownOptions() {
    dropdownOptions = [];
    renderDropdownOptions();
    document.querySelector('.optionInput').value = '';
  }

  // Preview and Save (Aura)
  function previewAuraTemplate() {
    const type = document.getElementById('tetherType').value.trim();
    const desc = document.getElementById('tetherDesc').value.trim();
    const preview = document.getElementById('aura-preview');
    let html = `<div><b>Tether Type:</b> ${type || '<i>(none)</i>'}</div>`;
    html += `<div><b>Description:</b> ${desc || '<i>(none)</i>'}</div>`;
    // External Links
    const linksList = document.getElementById('linksList').querySelectorAll('.link-row');
    let links = [];
    linksList.forEach(row => {
      const label = row.querySelector('.linkLabel').value.trim();
      const url = row.querySelector('.linkUrl').value.trim();
      if (label && url) links.push({label, url});
    });
    if (links.length > 0) {
      html += `<div style="margin-top:1em;"><b>Links:</b><ul>`;
      links.forEach(link => {
        html += `<li>${link.label}: <a href="${link.url}" target="_blank">${link.url}</a></li>`;
      });
      html += `</ul></div>`;
    }
    html += `<div style="margin-top:1em;"><b>User Diary Entry Fields:</b></div>`;
    if (entryFields.length === 0) html += `<div><i>No entry fields added yet.</i></div>`;
    else {
      html += '<ul>';
      entryFields.forEach(field => {
        let extra = '';
        if (field.type === 'dropdown' && field.options)
          extra = ' <span style="color:#44c678;">(' + field.options.join(', ') + ')</span>';
        html += `<li>${field.label} <span style="color:#888;">[${field.type}]</span>${extra}</li>`;
      });
      html += '</ul>';
    }
    preview.innerHTML = html;
    preview.classList.remove('hidden');
  }
  function saveAuraTemplate() {
    const type = document.getElementById('tetherType').value.trim();
    const desc = document.getElementById('tetherDesc').value.trim();
    let image = document.getElementById('tetherImage').files[0] || null;
    // Gather links
    const linksList = document.getElementById('linksList').querySelectorAll('.link-row');
    let links = [];
    linksList.forEach(row => {
      const label = row.querySelector('.linkLabel').value.trim();
      const url = row.querySelector('.linkUrl').value.trim();
      if (label && url) links.push({label, url});
    });
    const template = {
      tetherType: type,
      description: desc,
      image,
      links,
      entryFields
    };
    alert('Aura template saved!\n\n' + JSON.stringify(template, null, 2));
    resetAuraCreator();
  }
  function resetAuraCreator() {
    entryFields = [];
    dropdownOptions = [];
    document.getElementById('fieldsList').innerHTML = '';
    document.getElementById('aura-preview').classList.add('hidden');
    document.getElementById('aura-preview').innerHTML = '';
    resetLinks();
    resetDropdownOptions();
    document.getElementById('tetherType').value = '';
    document.getElementById('tetherDesc').value = '';
    document.getElementById('tetherImage').value = '';
    document.getElementById('newFieldName').value = '';
    document.getElementById('newFieldType').value = 'text';
  }

  // Init UI on load
  showTerraCreator();
  resetLinks();
</script>
</body>
</html>
